Metadata-Version: 2.2
Name: pipes
Version: 1.0.0
Summary: Add your description here
Requires-Python: >=3.10
Description-Content-Type: text/markdown
Requires-Dist: kfp>=2.11.0
Dynamic: requires-python

## Setup

Testing commit.

```bash
# Install Docker, minikube, kubectx
sudo snap install kubectx --classic

# Ensure Docker is running (macOS)
open -a Docker

# Need cluster working (on Docker) to run kf
minikube start

# Deploy kfp resources
export PIPELINE_VERSION=2.3.0
kubectl apply -k "github.com/kubeflow/pipelines/manifests/kustomize/cluster-scoped-resources?ref=$PIPELINE_VERSION"
kubectl wait --for condition=established --timeout=60s crd/applications.app.k8s.io
kubectl apply -k "github.com/kubeflow/pipelines/manifests/kustomize/env/dev?ref=$PIPELINE_VERSION"

```

## Usage

The repo is split into two parts: a compiler and a kfp client wrapper.
The "compiler" creates a Docker container to output the pipeline Argo YAML.
The wrapper is merely a script which pushes the pipeline YAML onto a
local (minikube-based) KFlow Pipelines UI.

First, build and run the compiler:
```bash
make build
make compile
```

This should output a `pipeline.yaml` in your local `outputs/` folder.

Then, push the pipeline onto KFlow (make sure you have a running, not pending,
minikube KF Pipelines setup):
```bash
make run
```

## Experience

### MinIO
I chose to use this as a local storage server in between pipeline steps. It
comes with Kubeflow and is relatively straightforward to set up and use for
local demonstration.

You can access the MinIO UI by port forwarding to the service and logging in
with the `minio/minio123` default credentials:

```bash
make port-forward-minio
```

Optionally, install the CLI to access MinIO directly from terminal, instead of
port forwarding  (Brew or Snap for macOS / Linux respectively). Then, configure
to talk to KFlow's instance:

```bash
mc config host add minio http://localhost:9000 minio minio123
```

## Frustrations

1. Had to install `kfp` through `pip` instead of `conda`
as otherwise internal imports failed (`requests_toolbox.appengine`)
2. O God. Never use WSL. Just invest in a Mac
3. "When you're going through Dependency Hell, keep going" -- Winston Churchill

## Choices

### Infrastructure
Options considered:
1. `minikube`
2. GKE

Using GKE would require setting up the infra (e.g. with Terraform or similar,
or ClickOps) 

### Storage
Options considered:
1. MinIO
2. Volumes
3. Direct input / output passing

